<div class="page-container">
<div class="card">
  <div class="card-header" style="height: 40px;">
    <h4 style="margin-top:10px">Your Dashboard</h4>
  </div>
  <div class="card-body" style="height: 80px;">
    <div class="formGroup text-center"> 
      <a class="btn btnPrimary" routerLink="/new-workout" style="font-size: 18px; padding: 10px 20px;">
        Add Workout <i class="bi bi-plus" style="font-size: 18px;"></i>
      </a>
    </div>
  </div>
</div>

<div class="card">
  <div class="card-header" style="height: 40px;">
    <h4 tyle="margin-top:10px">Your Statistics</h4>
  </div>
  <div class="card-body">
    <div class="row">
      <div class="col-md-3" style="margin-left: 100px; margin-top: 80px; margin-right: 80px;"> 
        <div class="chart-container" style="height: 400px; max-height: 400px;">
            <canvas #averageWeightProgressCanvas></canvas>
        </div>
      </div>
      <div class="col-md-4 mt-0">
        <div class="chart-container" style="height: 400px; max-height: 400px; flex-direction: column; align-items: center; text-align: center">
          <div>
            <canvas #chartCanvas></canvas>
            <select [(ngModel)]="selectedExercise" (change)="getWeightProgressForExercises()" style="margin-top: 50px; margin-right: 20px;">
              <option *ngFor="let exercise of exercises" [value]="exercise">{{exercise}}</option>
            </select>
          
            <input type="date" [(ngModel)]="startDate" (change)="getWeightProgressForExercises()" style="margin-right: 20px;">
            <input type="date" [(ngModel)]="endDate" (change)="getWeightProgressForExercises()">
          </div>
        </div>
      </div>

   
        <!-- Card for workout-history -->
        <div class="col-md-3" style="margin-left: 50px;">
          <div class="card my-4">
            <div class="card-header" style="background-color: #6a5acd; color: white;">
              <h6 style="margin-top: 10px">Your Workout History</h6>
            </div>
            <div class="card-body-history" style="height: 250px; overflow-y: auto;">
              <ul class="list-group list-group-flush">
                <li class="list-group-item" *ngFor="let workout of workouts">
                  <details>
                    <summary>
                      <div class="summary-container d-flex justify-content-between align-items-center">
                        <div class="summary-content">
                          <h6>{{ workout.workoutName }}</h6>
                          <p>{{ workout.createdDate | date }}</p>
                        </div>
                        <div>
                          <ng-container *ngIf="workout.workout_sets.length > 0">
                            <i class="bi bi-chevron-down" style="margin-right: 10px;"></i>
                          </ng-container>
                          <button class="btn btn-secondary btn-sm" (click)="confirmDelete(workout.workoutID)" title="Delete Workout">
                            <i class="bi bi-trash"></i>
                          </button>
                        </div>
                      </div>
                    </summary>
                  <ul class="list-group">
                    <li class="list-group-item" *ngFor="let set of workout.workout_sets">
                      <p style="margin-top: 0px; margin-bottom: 0px;">Exercise: {{ exerciseDetails[set.exerciseID]?.exerciseName }}</p>
                      <p style="margin-top: 0px; margin-bottom: 0px;">Reps: {{ set.reps }}</p>
                      <p style="margin-top: 0px; margin-bottom: 0px;">Weight: {{ set.weights }} kg</p>
                     
                    </li>
                  </ul>
                </details>
                </li>
              </ul>
            </div>
          </div>
        <!--Your Last Workout-->
          <div class="card my-4 last-workout-card">
            <div class="card-header" style="background-color: #406178; color: white;">
              <h6 style="margin-top: 10px">Your Last Workout</h6>
            </div>
            <div class="card-body-history" >
              <details *ngIf="lastWorkout">
                <summary>
                  <div class="summary-container">
                    <div class="summary-content">
                      <h6 style="margin-top: 10px; margin-left: 10px;">{{ lastWorkout.workoutName }}</h6>
                      <p style="margin-top: 10px; margin-left: 10px;">{{ lastWorkout.createdDate | date }}</p>
                    </div>
                    <div class="summary-icon" *ngIf="lastWorkout.workout_sets.length > 0">
                      <i class="bi bi-chevron-down"></i> 
                    </div>
                  </div>
                </summary>
                <ul class="list-group">
                  <li class="list-group-item" *ngFor="let set of lastWorkout.workout_sets">
                    <p style="margin-top: 0px; margin-bottom: 0px;">Exercise: {{ exerciseDetails[set.exerciseID]?.exerciseName }}</p>
                    <p style="margin-top: 0px; margin-bottom: 0px;">Reps: {{ set.reps }}</p>
                    <p style="margin-top: 0px; margin-bottom: 0px;">Weight: {{ set.weights }} kg</p> 
                  </li>
                </ul>
              </details>
          
          </div>

    </div> 
  </div>
</div> 
</div>
</div>